{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <h1 class="mb-4">All Users</h1>

  <table class="table table-striped table-hover">
    <thead class="table-dark">
      <tr>
        <th>Username</th>
        <th>City</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u.user.username }}</td>
        <td>{{ u.city }}</td>
        <td>
          <!-- Show Update button only if current user is the owner OR superuser -->
          {% if request.user == u.user or request.user.is_superuser %}
          <a href="{% url 'user_update' u.id %}" class="btn btn-sm btn-success me-2">
            Update
          </a>
          {% endif %}

          <!-- Show Delete button only for superusers -->
          {% if request.user.is_superuser %}
          <a href="{% url 'user_delete' u.id %}" class="btn btn-sm btn-danger">
            Delete
          </a>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="3" class="text-center">
          <em>No users found.</em>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
